# Frontend Guide: News Spectrum Data

This document explains how to fetch and display the news data generated by the backend pipeline.

## 1. Database Schema

The pipeline runs every 3 hours and saves results to two main tables in Supabase.

### A. Global Megatopics (`mvp2_megatopics`)
Contains the top-level global themes (e.g., "Ukraine Power Outage", "Hong Kong Fire").

- **Table**: `mvp2_megatopics`
- **Key Columns**:
  - `id`: UUID
  - `name`: Megatopic Title (Korean)
  - `countries`: Array of country codes involved (e.g., `['KR', 'US', 'RU']`)
  - `total_articles`: Total number of articles across all countries
  - `content`: Full JSON object containing detailed local topics (Use this for rendering!)
  - `created_at`: Timestamp

**Query Example (Get Latest Megatopics):**
```javascript
const { data, error } = await supabase
  .from('mvp2_megatopics')
  .select('*')
  .order('created_at', { ascending: false })
  .limit(10); // Get top 10 from the latest batch
```

### B. Local Topics (`mvp2_topics`)
Contains country-specific topics (e.g., "US Election Update", "Korea Subway Strike").

- **Table**: `mvp2_topics`
- **Key Columns**:
  - `id`: UUID
  - `country_code`: Country Code (e.g., 'US')
  - `topic_name`: Topic Title
  - `article_ids`: Array of Article IDs belonging to this topic
  - `stances`: JSON object with article IDs grouped by stance (`factual`, `critical`, `supportive`)
  - `created_at`: Timestamp

**Query Example (Get Topics for a Specific Country):**
```javascript
const { data, error } = await supabase
  .from('mvp2_topics')
  .select('*')
  .eq('country_code', 'US')
  .order('created_at', { ascending: false })
  .limit(20);
```

## 2. Display Logic

### Homepage (Global View)
1. Fetch from `mvp2_megatopics`.
2. Display the `name` as the main headline.
3. Show flags for each country in `countries`.
4. (Optional) On click, expand to show `content.local_topics` which contains the breakdown by country.

### Country Page (Local View)
1. Fetch from `mvp2_topics` filtering by `country_code`.
2. Display `topic_name`.
3. Use `article_ids` to fetch actual article details from `mvp2_articles` if needed (join query).

## 3. Note on Data Freshness
- The pipeline runs every **3 hours**.
- It analyzes articles from the **last 24 hours**.
- Always sort by `created_at` descending to get the latest snapshot.
